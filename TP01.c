#include <stdio.h>
#include <stdlib.h>
typedef enum {
	False, True
}Bool;

typedef struct page{
	int num;
	struct page* suiv;
}*Page;


Page insertPage(Page tete, int numPage){
	Page newPage = (Page)malloc(sizeof(Page));
	newPage->num = numPage;
	newPage->suiv = NULL;
	if (tete == NULL)
		tete = newPage;
	else{
		Page P = tete;
		while(P->suiv != NULL)	P = P->suiv;
		P->suiv = newPage;
	}
	return tete;
}
Page extractPage(Page tete, Page *victime){
	(*victime) = (Page) malloc(sizeof(Page));
	(*victime)->num = tete->num;
	(*victime)->suiv = NULL;
	tete = tete->suiv;
	return tete;
}

void affichegeListPage(Page tete){
	if (tete == NULL)
		printf("La listes des pages est vide !");
	else{
		while(tete != NULL){
			printf("info : %d \n", tete->num);
			tete = tete->suiv;
		}
	}
}

Page creationListPage(){
	Page tete =  NULL;
	tete = insertPage(tete, 0);
	tete = insertPage(tete, 0);
	tete = insertPage(tete, 1);
	tete = insertPage(tete, 0);
	tete = insertPage(tete, 3);
	tete = insertPage(tete, 1);
	tete = insertPage(tete, 2);
	tete = insertPage(tete, 2);
	tete = insertPage(tete, 4);
	tete = insertPage(tete, 4);
	tete = insertPage(tete, 3);
	tete = insertPage(tete, 0);
	return tete;
}
Page creationMemoire(){
	Page tete =  NULL;
	tete = insertPage(tete, -1); // -1 signifie que elle est vide !
	tete = insertPage(tete, -1); // -1 signifie que elle est vide !
	return tete;
}

Bool isEmpty(Page tete){
	if(tete == NULL)
		return True;
	else return False;
}
Bool exist(Page mem, int numPage){
	Bool find = False;
	while(mem!=NULL && !find){
		if(mem->num == numPage)
			find = True;
		else mem = mem->suiv;
	}
	return find;
}
Bool isNotFull(Page mem){
	while(mem!=NULL)
	{
		if(mem->num == -1)
			return True;
		mem = mem->suiv;
	}
	return False;
}

Page pageInMem(Page mem, Page pg){
	Page P = mem;
	while(P->num != -1)	P = P->suiv;
	P->num = pg->num;
	return mem;
}

Page deleteVictimPage(Page mem, Page pg){
	Page P = mem;
	while(P->num != pg->num) P = P->suiv;
		P->num = -1;
	return mem;
}

int FIFO(Page tete, Page memoire){
	int defautDePage = 0;
	Page File = NULL;

	while(!isEmpty(tete)){
		if(!exist(memoire, tete->num)){
			defautDePage++;
			if(isNotFull(memoire)){
				memoire = pageInMem(memoire, tete);
				File = insertPage(File, tete->num);
			}
			else{ // FULL
				// en doit choisir une page victime !!
				Page victime;
				File = extractPage(File, &victime);

				memoire = deleteVictimPage(memoire, victime);

				memoire = pageInMem(memoire, tete);
				File = insertPage(File, tete->num);
			}
		}
		/*
		printf("Memoire %d: \n\n", tete->num);
		affichegeListPage(memoire);
		printf("\n\n");
		*/
		tete = tete->suiv;

	}

	return defautDePage;
}
int main(){
	Page memoire = creationMemoire(); // Creation de la memoire .
	Page tete =  creationListPage(); // Creation des pages .
	/*
	affichegeListPage(tete);
	affichegeListPage(memoire);
	*/

	printf("Nombre de defaut de page = %d", FIFO(tete, memoire));

	return 0;
}





